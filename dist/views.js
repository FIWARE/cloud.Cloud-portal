var AllocateIPView=Backbone.View.extend({_template:_.itemplate($("#allocateIPFormTemplate").html()),events:{"click #cancelCreateBtn":"close","click #close":"close","click #createBtn":"create","click .modal-backdrop":"close"},render:function(){$(this.el).append(this._template({model:this.model}));$(".modal:last").modal();return this},close:function(){$("#create_keypair").remove();$(".modal-backdrop").remove();this.onClose()},onClose:function(){this.undelegateEvents();this.unbind()},create:function(){self=
this;var a=$("input[name=name]").val(),b;for(b in self.model.models)if(self.model.models[b].attributes.name===a){a=new MessagesView({el:"#content",state:"Error",title:"Keypair "+a+" already exists. Please try again."});a.render();return}(new Keypair).set({name:a});mySuccess=function(a){a=new Blob([a.keypair.private_key],{type:"application/x-pem-file"});a=window.URL.createObjectURL(a);window.open(a)};JSTACK.Nova.createkeypair(a,void 0,mySuccess);window.location.href="#nova/access_and_security/keypairs/"+
a+"/download/";a=new MessagesView({el:"#content",state:"Success",title:"Keypair "+a+" created."});a.render();self.close()}});var LoginView=Backbone.View.extend({_template:_.itemplate($("#not_logged_in").html()),initialize:function(){console.log("Init Login view");this.model.bind("change:loggedIn",this.onLogin,this);this.model.bind("auth-error",this.renderonerror,this);this.model.bind("auth-needed",this.render,this);this.onLogin()},events:{"click #home_loginbtn":"onCredentialsSubmit","click .close":"onCloseErrorMsg"},onCredentialsSubmit:function(a){a.preventDefault();this.model.setCredentials(this.$("input[name=username]").val(),
this.$("input[name=password]").val())},onCloseErrorMsg:function(){this.model.set({error_msg:null});this.renderonerror()},onLogin:function(){console.log("Checking");this.model.get("loggedIn")&&(window.location.href=void 0!==this.options.next_view?"#"+this.options.next_view:"#syspanel")},render:function(){console.log("Rendering login");var a=this;$(this.el).fadeOut("slow",function(){$("#root").css("display","none");$(a.el).empty().html(a._template(a.model));$(a.el).fadeIn("slow")});return this},renderonerror:function(){$("#root").css("display",
"none");$(this.el).empty().html(this._template(this.model));return this}});var ChangePasswordView=Backbone.View.extend({_template:_.itemplate($("#changePasswordFormTemplate").html()),events:{"click #cancelBtn":"close","click #close":"close","click #updateBtn":"update","click .modal-backdrop":"close"},initialize:function(){},onClose:function(){this.undelegateEvents();this.unbind()},render:function(){if(null==$("#change_password").html())return $(this.el).append(this._template({model:this.model})),$(".modal:last").modal(),this},close:function(){this.model.unbind("change",
this.render,this);$("#change_password").remove();$(".modal-backdrop").remove();this.onClose()},update:function(){this.model.changepassword($("input[name=instance_password]").val());(new MessagesView({el:"#content",state:"Success",title:"Password changed."})).render();this.close()}});var ConfirmView=Backbone.View.extend({_template:_.itemplate($("#confirmTemplate").html()),initialize:function(){this.delegateEvents({"click #confirm_btn":"onAccept","click #cancelBtn":"close","click #closeModalConfirm":"close","click .modal-backdrop":"close"});this.options.title=this.options.title||"Are you sure?";this.options.message=this.options.message||"Please confirm your selection. This action cannot be undone.";this.options.btn_message=this.options.btn_message||"Confirm"},onClose:function(){""===
this.options.style&&void 0===this.options.style&&(this.undelegateEvents(),this.unbind())},render:function(){null!=$("#confirm").html()&&($("#confirm").remove(),$(".modal-backdrop").remove());$(this.el).append(this._template({title:this.options.title,message:this.options.message,btn_message:this.options.btn_message,style:this.options.style}));""!==this.options.style&&void 0!==this.options.style?($(".modal:last").modal(),$(".modal-backdrop:last").css("z-index","105010")):$(".modal:last").modal();return this},
onAccept:function(){this.options.onAccept();this.close()},close:function(){$("#confirm").remove();""===this.options.style&&void 0===this.options.style&&(this.undelegateEvents(),$(".modal-backdrop").remove(),this.onClose())}});var ConsultImageDetailView=Backbone.View.extend({_template:_.itemplate($("#consultImageDetailFormTemplate").html()),initialize:function(){this.model.bind("change",this.render,this);this.model.fetch()},render:function(){null==$("#instance_details").html()?UTILS.Render.animateRender(this.el,this._template,{model:this.model}):$(this.el).html(this._template({model:this.model}));return this}});var CopyObjectView=Backbone.View.extend({_template:_.itemplate($("#copyObjectFormTemplate").html()),events:{"click #submit":"onSubmit","click #cancelBtn":"close","click #close":"close","click .modal-backdrop":"close"},close:function(){$("#create_container").remove();$(".modal-backdrop").remove();this.onClose()},onClose:function(){this.undelegateEvents();this.unbind()},render:function(){null!=$("#create_container").html()&&($("#create_container").remove(),$(".modal-backdrop").remove());$(this.el).append(this._template({title:this.options.title,
container:this.containerName,model:this.options}));$(".modal:last").modal();return this},onSubmit:function(a){a.preventDefault();var b,d,c,e;void 0===this.$("input[name=objName]").val()?(e=new MessagesView({el:"#content",state:"Error",title:"Wrong input values for container. Please try again."}),e.render()):(b=this.model.get("name"),d=this.options.title,c=this.$("#container_switcher option:selected").val(),a=void 0===a.target.value||""===a.target.value?this.$("input[name=objName]").val():a.target.value,
e=new MessagesView({el:"#content",state:"Success",title:"Object "+a+" copied to conatainer "+c}),e.render(),this.model.copyObject(b,d,c,a))}});var CreateContainerView=Backbone.View.extend({_template:_.itemplate($("#createContainerFormTemplate").html()),events:{"click #submit":"onSubmit","click #cancelBtn":"close","click #close":"close","click .modal-backdrop":"close"},close:function(){$("#create_container").remove();$(".modal-backdrop").remove();this.onClose()},onClose:function(){this.undelegateEvents();this.unbind()},render:function(){null!=$("#create_container").html()&&($("#create_container").remove(),$(".modal-backdrop").remove());$(this.el).append(this._template({model:this.model}));
$(".modal:last").modal();return this},onSubmit:function(a){a.preventDefault();var b;if(""===this.$("input[name=name]").val()||void 0===this.$("input[name=name]").val())a=new MessagesView({el:"#content",state:"Error",title:"Wrong input values for container. Please try again."}),a.render();else{for(b in this.model.models)if(this.$("input[name=name]").val()===this.model.models[b].get("id")){a=new MessagesView({el:"#content",state:"Error",title:"Container with the same name already exists."});a.render();
this.close();return}a=new Container;a.set({name:this.$("input[name=name]").val()});a.save();a=new MessagesView({el:"#content",state:"Success",title:"Container "+a.get("name")+" created."});a.render();this.close()}this.close()}});var CreateFlavorView=Backbone.View.extend({_template:_.itemplate($("#createFlavorFormTemplate").html()),events:{"click #submit":"onSubmit","click #cancelBtn":"close","click #close":"close"},initialize:function(){this.model.bind("change",this.render,this)},close:function(){this.model.unbind("change",this.render,this);$("#create_flavor").remove();$(".modal-backdrop").remove();this.onClose()},onClose:function(){this.undelegateEvents();this.unbind()},render:function(){for(var a=0;a<this.model.length;a++);
null!=$("#create_flavor").html()&&($("#create_flavor").remove(),$(".modal-backdrop").remove());$(this.el).append(this._template({model:this.model}));$(".modal:last").modal();return this},onSubmit:function(a){a.preventDefault();""===this.$("input[name=flavor_id]").val()||""===this.$("input[name=name]").val()||""===this.$("input[name=vcpus]").val()||""===this.$("input[name=memory_mb]").val()||""===this.$("input[name=disk_gb]").val()||""===this.$("input[name=eph_gb]").val()||0>=this.$("input[name=flavor_id]").val()||
0>=this.$("input[name=vcpus]").val()||0>=this.$("input[name=memory_mb]").val()||0>=this.$("input[name=disk_gb]").val()||0>=this.$("input[name=eph_gb]").val()||0!==this.$("input[name=flavor_id]").val()%1||0!==this.$("input[name=vcpus]").val()%1||0!==this.$("input[name=memory_mb]").val()%1||0!==this.$("input[name=disk_gb]").val()%1||0!==this.$("input[name=eph_gb]").val()%1?(console.log($("input[name=flavor_id]")),console.log($("input[name=name]")),console.log($("input[name=vcpus]")),console.log($("input[name=memory_mb]")),
console.log($("input[name=disk_gb]")),console.log($("input[name=eph_gb]")),a=new MessagesView({el:"#content",state:"Error",title:"Wrong input values for flavor. Please try again."})):(a=new Flavor,a.set({flavor_id:this.$("input[name=flavor_id]").val()}),a.set({name:this.$("input[name=name]").val()}),a.set({vcpus:this.$("input[name=vcpus]").val()}),a.set({memory_mb:this.$("input[name=memory_mb]").val()}),a.set({disk_gb:this.$("input[name=disk_gb]").val()}),a.set({eph_gb:this.$("input[name=eph_gb]").val()}),
a.save(),a=new MessagesView({el:"#content",state:"Success",title:"Flavor "+a.get("name")+" created."}));a.render();this.close()}});var CreateKeypairView=Backbone.View.extend({_template:_.itemplate($("#createKeypairFormTemplate").html()),events:{"click #cancelCreateBtn":"close","click #close":"close","click #createBtn":"create","click .modal-backdrop":"close","click #name":"showTooltipName"},render:function(){$(this.el).append(this._template({model:this.model}));$(".modal:last").modal();$(".createKeypair").attr("download",".pem");return this},close:function(){$("#create_keypair").remove();$(".modal-backdrop").remove();this.onClose()},
onClose:function(){this.undelegateEvents();this.unbind()},showTooltipName:function(){$("#name").tooltip("show")},create:function(a){a.preventDefault();self=this;var a=$("input[name=name]").val(),b;if(/^[a-z0-9_\-]{1,87}$/.test(a)){for(b in self.model.models)if(self.model.models[b].attributes.name===a){b=new MessagesView({el:"#content",state:"Error",title:"Keypair "+a+" already exists. Please try again."});b.render();return}window.location.href="#nova/access_and_security/keypairs/"+a+"/download/"}else b=
new MessagesView({el:"#content",state:"Error",title:"Wrong values for Keypair. Please try again."}),b.render();self.close()}});var CreateSecurityGroupView=Backbone.View.extend({_template:_.itemplate($("#createSecurityGroupFormTemplate").html()),events:{"click #cancelBtn":"close","click #close":"close","click #createBtn":"createSecurityGroup","click .modal-backdrop":"close","click #name":"showTooltipName"},render:function(){$(this.el).append(this._template({securityGroupsModel:this.options.securityGroupsModel}));$(".modal:last").modal();return this},close:function(){this.options.securityGroupsModel.unbind("change",this.render,
this);$("#create_security_group").remove();$(".modal-backdrop").remove();this.onClose()},onClose:function(){this.undelegateEvents();this.unbind()},showTooltipName:function(){$("#name").tooltip("show")},createSecurityGroup:function(a){a.preventDefault();self=this;var a=$("input[name=name]").val(),b=$("input[name=description]").val(),d,c;d=/^[a-z0-9_\-]{1,87}$/.test(a)?!0:!1;c=""!==b&&void 0!==b?!0:!1;console.log(d);console.log(c);if(d&&c){for(var e in self.options.securityGroupsModel.models)if(self.options.securityGroupsModel.models[e].attributes.name===
a){a=new MessagesView({el:"#content",state:"Error",title:"Security Group "+a+" already exists. Please try again."});a.render();return}e=new SecurityGroup;e.set({name:a,description:b});e.save();a=new MessagesView({el:"#content",state:"Success",title:"Security group "+a+" created."})}else a=new MessagesView({el:"#content",state:"Error",title:"Wrong values for Security Group. Please try again."});a.render();self.close()}});var CreateSnapshotView=Backbone.View.extend({_template:_.itemplate($("#createSnapshotFormTemplate").html()),events:{"click #cancelBtn":"close","click #close":"close","click #updateBtn":"update","click .modal-backdrop":"close"},initialize:function(){},render:function(){if(null==$("#create_snapshot").html())return $(this.el).append(this._template({model:this.model})),$(".modal:last").modal(),this},close:function(){this.model.unbind("change",this.render,this);$("#create_snapshot").remove();$(".modal-backdrop").remove()},
update:function(){var a=$("input[name=snapshot_name]").val();this.model.createsnapshot(a);(new MessagesView({el:"#content",state:"Success",title:"Snapshot "+a+" created."})).render();this.close()}});var CreateVDCServiceView=Backbone.View.extend({_template:_.itemplate($("#createVDCServiceFormTemplate").html()),instances:new Instances,events:{"click #submit":"onSubmit","click #cancelBtn":"close","click #close-service":"close","click .modal-backdrop":"close","click #addInstance":"addInstance"},initialize:function(){this.instances=new Instances;console.log(this.instances)},addInstance:function(){var a=this;console.log("Showing Instance Creation");(new LaunchImageView({el:"body",model:{},images:this.options.images,
flavors:this.options.flavors,keypairs:this.options.keypairs,addInstance:function(b){a.instances.add(b);a.renderSecond()}})).render()},close:function(a){a.preventDefault();console.log("Removing Create VDC");$("#create_service").remove();$(".modal-backdrop").remove();this.onClose()},onClose:function(){this.undelegateEvents();this.unbind()},renderSecond:function(){$("#create_service").remove();$(this.el).append(this._template({instances:this.instances,flavors:this.options.flavors}))},render:function(){null!==
$("#create_service").html()&&($("#create_service").remove(),$(".modal-backdrop").remove());$(this.el).append(this._template({instances:this.instances,flavors:this.options.flavors}));$("#create_service").modal();return this},onSubmit:function(a){a.preventDefault();this.close();""===this.$("input[name=name]").val()?a=new MessagesView({el:"#content",state:"Error",title:"Wrong input values for service. Please try again."}):(a=new VDCService,a.set({name:this.$("input[name=name]").val()}),a=new MessagesView({el:"#content",
state:"Success",title:"Service "+a.get("name")+" created."}));a.render()}});var CreateVolumeSnapshotView=Backbone.View.extend({_template:_.itemplate($("#createVolumeSnapshotFormTemplate").html()),events:{"click #cancelBtn":"close","click #close":"close","click #createBtn":"create","click .modal-backdrop":"close"},onClose:function(){this.undelegateEvents();this.unbind()},initialize:function(){},render:function(){if(null==$("#create_volume_modal").html())return $(this.el).append(this._template()),$(".modal:last").modal(),this},close:function(){$("#create_volume_snapshot_modal").remove();
$(".modal-backdrop").remove();this.onClose()},create:function(){var a=$("input[name=name]").val(),b=$("textarea[name=description]").val(),d=new VolumeSnapshot;d.set({volume_id:this.model.id,name:a,description:b});d.save();(new MessagesView({el:"#content",state:"Success",title:"Volume snapshot "+a+" created."})).render();this.close()}});var CreateVolumeView=Backbone.View.extend({_template:_.itemplate($("#createVolumeFormTemplate").html()),events:{"click #cancelBtn":"close","click #close":"close","click #createBtn":"create","click .modal-backdrop":"close"},onClose:function(){this.undelegateEvents();this.unbind()},initialize:function(){},render:function(){if(null==$("#create_volume_modal").html())return $(this.el).append(this._template()),$(".modal:last").modal(),this},close:function(){$("#create_volume_modal").remove();$(".modal-backdrop").remove();
this.onClose()},create:function(){var a=$("input[name=name]").val(),b=$("textarea[name=description]").val(),d=$("input[name=size]").val();this.model=new Volume;this.model.set({name:a,description:b,size:d});this.model.save();(new MessagesView({el:"#content",state:"Success",title:"Volume "+a+" created."})).render();this.close()}});var DownloadKeypairView=Backbone.View.extend({_template:_.itemplate($("#downloadKeypairFormTemplate").html()),initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.render,this)},events:{"click #cancelCreateBtn":"close","click #close":"close"},render:function(){$(this.el).append(this._template({model:this.model}));$(".modal:last").modal();this.createKeypair();return this},createKeypair:function(){var a=this.model.attributes.name;JSTACK.Nova.createkeypair(a,void 0,function(b){var d=
b.keypair.private_key;console.log(b.keypair.public_key);b=new Blob([d],{type:"application/x-pem-file"});b=window.URL.createObjectURL(b);window.open(b,"Save Keypair","width=0,height=0");$(".downloadKeypair").append("Download Keypair");$(".downloadKeypair").attr("href",b);$(".downloadKeypair").attr("download",a+".pem");(new MessagesView({el:"#content",state:"Success",title:"Keypair "+a+" created."})).render()})},close:function(){this.onClose()},onClose:function(){this.undelegateEvents();this.unbind()}});var EditSecurityGroupRulesView=Backbone.View.extend({_template:_.itemplate($("#editSecurityGroupRulesFormTemplate").html()),events:{"click #closeModal":"close","click #deleteRuleBtn":"deleteRule","click #deleteRulesBtn":"deleteRules","click .close":"close","click #createRuleBtn":"createRule","click .modal-backdrop":"close","click #from_port":"showTooltipFromPort","click #to_port":"showTooltipToPort","click #cidr":"showTooltipCidr","change .secGroupSelect":"dissapearCIDR","change .IPProtocolSelect":"changeInputs",
"change .checkbox_sec_group_rule":"enableDisableDeleteButton"},render:function(){$(this.el).append(this._template({securityGroupsModel:this.options.securityGroupsModel}));$(".modal:last").modal();return this},close:function(){$("#edit_security_group_rule").remove();this.onClose()},onClose:function(){this.undelegateEvents();this.unbind()},showTooltipFromPort:function(){$("#from_port").tooltip("show")},showTooltipToPort:function(){$("#to_port").tooltip("show")},showTooltipCidr:function(){$("#cidr").tooltip("show")},
dissapearCIDR:function(){"CIDR"!==$(".secGroupSelect :selected").val()?$(".cidrSelect").hide():$(".cidrSelect:hidden")&&$(".cidrSelect").show()},changeInputs:function(){"ICMP"==$(".IPProtocolSelect :selected").val()?($("label[for='from_port']").text("Type"),$("label[for='to_port']").text("Code")):($("label[for='from_port']").text("From Port"),$("label[for='to_port']").text("To Port"))},deleteRule:function(a){self=this;var b=a.target.value,d;for(d in this.options.securityGroupsModel.securityGroup.attributes.rules);
(new ConfirmView({el:"body",title:"Delete Security Group Rule",btn_message:"Delete Security Group Rule",style:"top: 80px; display: block; z-index: 10501010;",onAccept:function(){self.options.securityGroupsModel.securityGroup.deleteSecurityGroupRule(b);(new MessagesView({el:"#content",state:"Success",title:"Security Group Rule deleted."})).render()}})).render()},deleteRules:function(){var a=this;(new ConfirmView({el:"body",title:"Delete Security Group Rules",btn_message:"Delete Security Group Rules",
style:"top: 80px; display: block; z-index: 10501010;",onAccept:function(){$(".checkbox_sec_group_rule:checked").each(function(){var b=$(this).val(),d;for(d in a.options.securityGroupsModel.securityGroup.attributes.rules);d=new MessagesView({el:"#content",state:"Success",title:"Security Group Rules deleted."});a.options.securityGroupsModel.securityGroup.deleteSecurityGroupRule(b);d.render()})}})).render()},createRule:function(a){a.preventDefault();self=this;var b,d;d=/^([1-65535]){1,5}$/;var c=a.target.value,
e=$(".IPProtocolSelect :selected").val(),g=$("input[name=fromPort]").val(),f=$("input[name=toPort]").val(),h=$(".secGroupSelect :selected").val(),i=$("input[name=cidr]").val(),a=/^([0-255]){1,3}(\.){1}([0-255]){1,3}(\.){1}([0-255]){1,3}(\.){1}([0-255]){1,3}(\/){1}([0-24]){1,2}$/.test(i)?!0:!1;b=d.test(g)?!0:!1;d=d.test(f)?!0:!1;console.log("ipProtocol "+e);console.log("fromPort "+g);console.log("toPort "+f);console.log("cidr "+i);console.log("securityGroupId "+h);console.log("parentGroupId "+c);a&&
b&&d?("CIDR"!==$(".secGroupSelect :selected").val()?self.options.securityGroupsModel.securityGroup.createSecurityGroupRule(e,g,f,"",h,c):self.options.securityGroupsModel.securityGroup.createSecurityGroupRule(e,g,f,i,void 0,c),a=new MessagesView({el:"#content",state:"Success",title:"Security group rule created."})):a=new MessagesView({el:"#content",state:"Error",title:"Wrong input values for Security Group Rule. Please try again."});a.render();this.close()},enableDisableDeleteButton:function(){0<$(".checkbox_sec_group_rule:checked").size()?
$("#deleteRulesBtn").attr("disabled",!1):$("#deleteRulesBtn").attr("disabled",!0)}});var EditVolumeAttachmentsView=Backbone.View.extend({_template:_.itemplate($("#editVolumeAttachmentsFormTemplate").html()),events:{"click .cancelBtn":"close","click .close":"close","click .attachBtn":"attach","click .detachBtn":"detach","click .checkbox_attachments":"enableDisableDettachButton","click .modal-backdrop":"close","click #attachments__action_detach":"detachGroup"},onClose:function(){this.undelegateEvents();this.unbind()},initialize:function(){},render:function(){if(null==$("#create_volume_modal").html())return $(this.el).append(this._template({model:this.model,
instancesModel:this.options.instances})),$(".modal:last").modal(),this},close:function(){$("#attach_volume_modal").remove();$(".modal-backdrop").remove();this.onClose()},detach:function(a){var b=a.target.value;console.log("Detaching "+b);(new ConfirmView({el:"body",title:"Detach Volume",btn_message:"Detach Volume",style:"top: 80px; display: block; z-index: 10501010;",onAccept:function(){this.options.instances.get(b).detachvolume({volume_id:this.model.id});(new MessagesView({el:"#content",state:"Success",
title:"Volume "+name+" detached."})).render()}})).render()},attach:function(){var a=$("select[id=id_instance]").val(),b=$("input[name=device]").val();this.options.instances.get(a).attachvolume({volume_id:this.model.id,device:b});(new MessagesView({el:"#content",state:"Success",title:"Volume "+name+" attached."})).render();this.close()},detachGroup:function(){var a=this,b=$(".checkbox_attachments:checked");this.close();(new ConfirmView({el:"body",title:"Detach Volumes",btn_message:"Detach Volumes",
style:"top: 80px; display: block; z-index: 10501010;",onAccept:function(){b.each(function(){var b=$(this).val(),c=a.options.instances.get(b);a.options.instances.get(b).detachvolume({volume_id:a.model.id});(new MessagesView({el:"#content",state:"Success",title:"Volumes "+c.get("name")+" detached."})).render()})}})).render()},enableDisableDettachButton:function(){0<$(".checkbox_attachments:checked").size()?$("#attachments__action_detach").attr("disabled",!1):$("#attachments__action_detach").attr("disabled",
!0)}});var ImportKeypairView=Backbone.View.extend({_template:_.itemplate($("#importKeypairFormTemplate").html()),events:{"click #cancelImportBtn":"close","click #close":"close","click #importBtn":"importKeypair","click .modal-backdrop":"close"},render:function(){$(this.el).append(this._template({model:this.model}));$(".modal:last").modal();return this},close:function(){$("#import_keypair").remove();$(".modal-backdrop").remove();this.onClose()},onClose:function(){this.undelegateEvents();this.unbind()},importKeypair:function(){self=
this;var a=$("input[name=name]").val(),b=$("input[name=public_key]").val(),d=new Keypair,c;for(c in self.model.models)if(self.model.models[c].attributes.name===a){a=new MessagesView({el:"#content",state:"Error",title:"Keypair "+a+" already exists. Please try again."});a.render();return}d.set({name:a,public_key:b});d.save();a=new MessagesView({el:"#content",state:"Success",title:"Keypair "+a+" imported."});a.render();this.close()}});var LaunchImageView=Backbone.View.extend({_template:_.itemplate($("#launchImageTemplate").html()),events:{"click #cancelBtn-image":"close","click #close-image":"close","click .modal-backdrop":"close","click .btn-launch-image":"launch"},initialize:function(){this.options.keypairs.fetch()},render:function(){var a=this.options.flavors;if(null==$("#launch_image").html())return $(this.el).append(this._template({model:this.model.models,flavors:a,keypairs:this.options.keypairs})),$("#launch_image").modal(),
this},onClose:function(){this.undelegateEvents();this.unbind()},close:function(a){void 0!==a&&a.preventDefault();console.log("Removing launch image");$("#launch_image").remove();$(".modal-backdrop:last").remove();this.onClose();void 0!==this.model.unbond&&this.model.unbind("reset",this.render,this)},launch:function(){var a=new Instance,b=$("input[name=instance_name]").val(),d=this.model.id,c,e;$("#id_flavor option:selected").each(function(){var a=$(this).val();""!==a&&(c=a)});$("#id_keypair option:selected").each(function(){var a=
$(this).val();""!==a&&(e=a)});var g=$("textarea[name=user_data]").val(),f=$("input[name=count]").val(),h=$("input[name=count]").val();a.set({name:b});a.set({imageReg:d});a.set({flavorReg:c});a.set({key_name:e});a.set({user_data:g});a.set({security_groups:void 0});a.set({min_count:f});a.set({max_count:h});a.set({availability_zone:void 0});a.save();this.close()}});var LaunchVDCView=Backbone.View.extend({_template:_.itemplate($("#launchVDCTemplate").html()),events:{"click #cancelBtn":"close","click #close":"close","click .modal-backdrop":"close","click .btn-accept":"launch","click #myTab a":"show","click .btn-next":"showNext","click .btn-prev":"showPrevious"},initialize:function(){},showPrevious:function(){this.showTab($($("#myTab li[class=active]").prev("#myTab li").children()[0]))},showNext:function(){this.showTab($($("#myTab li[class=active]").next("#myTab li").children()[0]))},
show:function(a){a.preventDefault();this.showTab($(a.target))},showTab:function(a){a.tab("show");$("#myTab li[class=active]").html()===$("#myTab li:last").html()?$(".btn-next").hide():$(".btn-next").show();$("#myTab li[class=active]").html()===$("#myTab li:first").html()?$(".btn-prev").hide():$(".btn-prev").show()},render:function(){if(null==$("#launch_vdc").html())return $(this.el).append(this._template({})),$(".btn-prev").hide(),$(".modal:last").modal(),this},onClose:function(){this.undelegateEvents();
this.unbind()},close:function(){$("#launch_vdc").remove();$(".modal-backdrop").remove();this.onClose()},launch:function(){var a=new VDC;a.save();(new MessagesView({el:"#content",state:"Success",title:"Virtual Data Center "+a.get("name")+" launched."})).render();this.close()}});var MessagesView=Backbone.View.extend({_template:_.template($("#messagesTemplate").html()),initialize:function(){this.options.state=this.options.state||"Success"},close:function(){$(".messages").remove()},render:function(){var a=this;$(this.el).before(this._template({title:this.options.title,state:this.options.state}));$(".messages").fadeOut(4E3,function(){a.close()});return this}});var UpdateImageView=Backbone.View.extend({_template:_.itemplate($("#updateImageFormTemplate").html()),initialize:function(){this.model.bind("change",this.render,this);this.model.fetch()},events:{"click #image_update":"onUpdateImage","click #cancelBtn":"close","click #close":"close","click .modal-backdrop":"close"},render:function(){null!=$("#update_image").html()&&($("#update_image").remove(),$(".modal-backdrop").remove());$(this.el).append(this._template({model:this.model}));$(".modal:last").modal();
return this},onUpdateImage:function(a){a.preventDefault();this.model.set({name:this.$("input[name=name]").val()});this.model.save();(new MessagesView({el:"#content",state:"Success",title:"Image "+this.model.get("name")+" updated."})).render();this.close();$("#update_image").remove();$(".modal-backdrop").remove()},close:function(){this.model.unbind("change",this.render,this);$("#update_image").remove();$(".modal-backdrop").remove();this.onClose()},onClose:function(){this.undelegateEvents();this.unbind()}});var UpdateInstanceView=Backbone.View.extend({_template:_.itemplate($("#updateInstanceFormTemplate").html()),events:{"click #cancelBtn":"close","click #close":"close","click #updateBtn":"update","click .modal-backdrop":"close"},initialize:function(){this.model.bind("change",this.render,this);this.model.fetch()},onClose:function(){this.undelegateEvents();this.unbind()},render:function(){if(null==$("#update_instance").html())return $(this.el).append(this._template({model:this.model})),$(".modal:last").modal(),
this},close:function(){this.model.unbind("change",this.render,this);$("#update_instance").remove();$(".modal-backdrop").remove();this.onClose()},update:function(){this.model.set({name:this.$("input[name=name]").val()});var a=$("input[name=name]").val();this.model.save();(new MessagesView({el:"#content",state:"Success",title:"Instance "+a+" updated."})).render();this.close()}});var UploadObjectView=Backbone.View.extend({_template:_.itemplate($("#uploadObjectFormTemplate").html()),events:{"click #submit":"onSubmit","click #cancelBtn":"close","click #close":"close","click .modal-backdrop":"close"},close:function(){$("#upload_object").remove();$(".modal-backdrop").remove();this.onClose()},onClose:function(){this.undelegateEvents();this.unbind()},render:function(){null!=$("#upload_object").html()&&($("#upload_object").remove(),$(".modal-backdrop").remove());$(this.el).append(this._template({model:this.model}));
$(".modal:last").modal();return this},onSubmit:function(a){a.preventDefault();var b,d;""===this.$("input[name=objName]").val()?a=new MessagesView({el:"#content",state:"Error",title:"Wrong input values for container. Please try again."}):(a=this.model.get("name"),b=this.$("input[name=objName]").val(),d=document.getElementById("id_object_file").files[0],this.model.uploadObject(a,b,d),a=new MessagesView({el:"#content",state:"Success",title:"Object "+b+" uploaded."}));a.render();this.close()}});var AccessAndSecurityView=Backbone.View.extend({_template:_.itemplate($("#novaAccessAndSecurityTemplate").html()),keypairsView:void 0,securityGroupsView:void 0,floatingIPsView:void 0,initialize:function(){this.render();this.floatingIPsView=new NovaFloatingIPsView({floatingIPsModel:this.options.floatingIPsModel,el:"#floating_ips"});this.secuirtyGroupsView=new NovaSecurityGroupsView({securityGroupsModel:this.options.securityGroupsModel,el:"#security_groups"});this.keyparisView=new NovaKeypairsView({model:this.model,
el:"#keypairs"})},close:function(){this.options.securityGroupsModel.unbind("change",this.render,this);this.options.floatingIPsModel.unbind("change",this.render,this);this.model.unbind("change",this.render,this);$("#floating_ips").remove();$("#security_groups").remove();$("#keypairs").remove();this.undelegateEvents();this.unbind()},onClose:function(){this.keyparisView.close();this.secuirtyGroupsView.close();this.floatingIPsView.close();this.undelegateEvents();this.unbind()},render:function(){UTILS.Render.animateRender(this.el,
this._template)}});var NovaFloatingIPsView=Backbone.View.extend({_template:_.itemplate($("#novaFloatingIPsTemplate").html()),initialize:function(){this.options.floatingIPsModel.unbind("reset");this.options.floatingIPsModel.bind("reset",this.render,this);this.renderFirst()},events:{"click #release_floating_IPs":"releaseFloatingIPs","click #release_floating_IP":"releaseFloatingIP","click .btn-allocate":"allocateIP"},releaseFloatingIPs:function(){(new ConfirmView({el:"body",title:"Release Floating IP",btn_message:"Release Floating IPs",
onAccept:function(){(new MessagesView({el:"#content",state:"Success",title:"Floating IPs "+sec_group.name+" released."})).render()}})).render()},releaseFloatingIP:function(){},allocateIP:function(){console.log("allocate IP");(new AllocateIPView({el:"body",model:this.model})).render()},enableDisableDeleteButton:function(){0<$(".checkbox_floating_ips_:checked").size()?$("#ips_delete").attr("disabled",!1):$("#ips_delete").attr("disabled",!0)},renderFirst:function(){this.undelegateEvents();var a=this;
UTILS.Render.animateRender(this.el,this._template,{floatingIPsModel:this.options.floatingIPsModel},function(){a.enableDisableDeleteButton();a.delegateEvents(a.events)})},render:function(){var a,b;this.undelegateEvents();null!=$(".messages").html()&&$(".messages").remove();if(null!=$("#floating_ips").html()){var d=this._template({floatingIPsModels:this.options.floatingIPsModel.models}),c=[];for(a in this.options.floatingIPsModel.models)b=this.options.floatingIPsModel.models[a].id,$("#checkbox_floating_ips_"+
b).is(":checked")&&c.push(b);$(this.el).html(d);for(a in c)b=c[a],b=$("#checkbox_floating_ips_"+b),null!=b.html()&&b.prop("checked",!0);this.enableDisableDeleteButton()}this.delegateEvents(this.events);return this}});var InstanceDetailView=Backbone.View.extend({_template:_.itemplate($("#instanceDetailTemplate").html()),flavorResp:!1,imageResp:!1,vncResp:!1,logResp:!1,initialize:function(){var a=this;this.delegateEvents({"click #overviewBtn":"showOverview","click #instance_vnc":"showVNC","click #instance_logs":"showLogs","click #instance_software":"showSoftware","click #installed_software":"showInstalledSoftware","click #new_software":"showNewSoftware"});this.model.bind("change",this.onInstanceDetail,this);this.model.fetch();
this.model.vncconsole({callback:function(b){a.options.vncUrl=b.console.url;a.vncResp=!0;a.checkAll()}});this.model.consoleoutput({callback:function(b){a.options.logs=b.output;a.logResp=!0;a.checkAll()}})},showOverview:function(){$("#instance_details__overview").addClass("active");$("#instance_details__vnc").removeClass("active");$("#instance_details__log").removeClass("active");$("#instance_details__software").removeClass("active");$("#instance_details__installed_software").removeClass("active");
$("#instance_details__new_software").removeClass("active");$("#overview").addClass("active");$("#vnc").removeClass("active");$("#log").removeClass("active");$("#software").removeClass("active");$("#installed_software").removeClass("active");$("#new_software").removeClass("active")},showVNC:function(){$("#instance_details__overview").removeClass("active");$("#instance_details__log").removeClass("active");$("#instance_details__vnc").addClass("active");$("#instance_details__software").removeClass("active");
$("#instance_details__installed_software").removeClass("active");$("#instance_details__new_software").removeClass("active");$("#overview").removeClass("active");$("#log").removeClass("active");$("#vnc").addClass("active");$("#software").removeClass("active");$("#installed_software").removeClass("active");$("#new_software").removeClass("active")},showLogs:function(){$("#instance_details__overview").removeClass("active");$("#instance_details__vnc").removeClass("active");$("#instance_details__log").addClass("active");
$("#instance_details__software").removeClass("active");$("#instance_details__installed_software").removeClass("active");$("#instance_details__new_software").removeClass("active");$("#overview").removeClass("active");$("#vnc").removeClass("active");$("#log").addClass("active");$("#software").removeClass("active")},showSoftware:function(){this.options.subsubview="installed_software";$("#instance_details__overview").removeClass("active");$("#instance_details__vnc").removeClass("active");$("#instance_details__log").removeClass("active");
$("#instance_details__software").addClass("active");$("#overview").removeClass("active");$("#vnc").removeClass("active");$("#log").removeClass("active");$("#software").addClass("active");$("#installed_software").addClass("active");$("#new_software").removeClass("active");this.showInstalledSoftware()},showInstalledSoftware:function(){$("#installed_software").addClass("active");$("#instance_details__installed_software").addClass("active");$("#new_software").removeClass("active");$("#instance_details__new_software").removeClass("active")},
showNewSoftware:function(){$("#installed_software").removeClass("active");$("#instance_details__installed_software").removeClass("active");$("#new_software").addClass("active");$("#instance_details__new_software").addClass("active")},onClose:function(){this.undelegateEvents();this.unbind()},close:function(){this.undelegateEvents();$("#instance_details__overview").removeClass("active");$("#instance_details__log").removeClass("active");$("#instance_details__vnc").removeClass("active");$("#instance_details__software").removeClass("active");
$("#instance_details__installed_software").removeClass("active");$("#instance_details__new_software").removeClass("active");$("#overview").removeClass("active");$("#log").removeClass("active");$("#vnc").removeClass("active");$("#software").removeClass("active");$("#installed_software").removeClass("active");$("#new_software").removeClass("active");this.onClose()},onInstanceDetail:function(){var a=this;this.options.flavor=new Flavor;this.options.flavor.set({id:this.model.get("flavor").id});this.options.flavor.bind("change",
function(){a.flavorResp=!0;a.checkAll()},this);this.options.image=new ImageVM;this.options.image.set({id:this.model.get("image").id});this.options.image.bind("change",function(){a.imageResp=!0;a.checkAll()},this);this.options.image.fetch();this.options.flavor.fetch();this.checkAll()},checkAll:function(){this.flavorResp&&this.imageResp&&this.render()},render:function(){var a=this;null==$("#consult_instance").html()?(mySuccess=function(b){UTILS.Render.animateRender(a.el,a._template,{rules:b.security_groups[0].rules,
vdc:a.options.vdc,service:a.options.service,model:a.model,flavor:a.options.flavor,image:a.options.image,logs:a.options.logs,vncUrl:a.options.vncUrl,subview:a.options.subview,subsubview:a.options.subsubview})},JSTACK.Nova.getsecuritygroupforserver(a.model.id,mySuccess)):(mySuccess=function(a){$(this.el).html(this._template({rules:a.security_groups[0].rules,vdc:this.options.vdc,service:this.options.service,model:this.model,flavor:this.options.flavor,image:this.options.image,logs:this.options.logs,vncUrl:this.options.vncUrl,
subview:this.options.subview,subsubview:this.options.subsubview}))},JSTACK.Nova.getsecuritygroupforserver(this.model.id,mySuccess));"log"==this.options.subview?this.showLogs():"vnc"==this.options.subview?this.showVNC():"software"==this.options.subview&&this.showSoftware();"installed_software"==this.options.subsubview?this.showInstalledSoftware():"new_software"==this.options.subsubview&&this.showNewSoftware();$("#instance_vnc").unbind();$("#instance_logs").unbind();$("#installed_software").unbind();
$("#new_software").unbind();$("#instance_software").unbind();$("#instance_vnc").bind("click",this.showVNC);$("#instance_logs").bind("click",this.showLogs);$("#instance_software").bind("click",this.showSoftware);$("#installed_software").bind("click",this.showInstalledSoftware);$("#new_software").bind("click",this.showNewSoftware);return this}});var NovaInstanceSnapshotsView=Backbone.View.extend({_template:_.itemplate($("#novaInstanceSnapshotsTemplate").html()),dropdownId:void 0,initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.render,this);this.renderFirst()},events:{"change .checkbox_images":"enableDisableDeleteButtonImages","click .btn-delete-group-images":"onDeleteGroupImages","click .btn-edit-images":"onEditImages","click .btn-launch-images":"onLaunchImages","change .checkbox_instances":"enableDisableDeleteButtonInstances",
"click .btn-delete-group-instances":"onDeleteGroupInstances","click .btn-delete-instances":"onDeleteInstances","click .btn-edit-instances":"onEditInstances","click .btn-launch-instances":"onLaunchInstances"},onClose:function(){this.undelegateEvents();this.unbind()},enableDisableDeleteButtonImages:function(){0<$(".checkbox_images:checked").size()?$("#images_delete").attr("disabled",!1):$("#images_delete").attr("disabled",!0)},onDeleteGroupImages:function(){var a=this;(new ConfirmView({el:"body",title:"Delete Images",
btn_message:"Delete Images",onAccept:function(){$(".checkbox_images:checked").each(function(){var b=$(this).val(),b=a.model.get(b);b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Images "+b.get("name")+" deleted."})).render()})}})).render()},onLaunchImages:function(a){a=this.model.get(a.target.value);(new LaunchImageView({model:a,flavors:this.options.flavors,keypairs:this.options.keypairs,el:"body"})).render()},onEditImages:function(a){a=this.model.get(a.target.value);(new UpdateImageView({model:a,
el:"body"})).render()},enableDisableDeleteButtonInstances:function(){0<$(".checkbox_instances:checked").size()?$("#instance_delete").attr("disabled",!1):$("#instance_delete").attr("disabled",!0)},onDeleteInstances:function(a){var b=this.model.get(this.model.get(a.target.value));(new ConfirmView({el:"body",title:"Delete Instance Snapshot",btn_message:"Delete Instance Snapshot",onAccept:function(){b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Instance snapshot "+b.get("name")+
" deleted."})).render()}})).render()},onDeleteGroupInstances:function(){var a=this;(new ConfirmView({el:"body",title:"Delete Instance Snapshots",btn_message:"Delete Instance Snapshots",onAccept:function(){$(".checkbox_instances:checked").each(function(){var b=$(this).val(),b=a.model.get(b);b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Instance snapshot "+b.get("name")+" deleted."})).render()})}})).render()},onLaunchInstances:function(a){a=this.model.get(a.target.value);(new LaunchImageView({model:a,
flavors:this.options.flavors,keypairs:this.options.keypairs,el:"body"})).render()},onEditInstances:function(a){a=this.model.get(a.target.value);(new UpdateImageView({model:a,el:"body"})).render()},renderFirst:function(){UTILS.Render.animateRender(this.el,this._template,this.model);this.undelegateEvents();this.delegateEvents(this.events)},render:function(){this.undelegateEvents();this.delegateEvents(this.events);if(null!=$("#images").html()){var a=this._template(this.model),b=[],d=[],c=[],e=[],g,f;
for(g in this.model.models)f=this.model.models[g].id,$("#checkbox_images_"+f).is(":checked")&&b.push(f),$("#dropdown_images_"+f).hasClass("open")&&d.push(f);for(g in this.model.models)f=this.model.models[g].id,$("#checkbox_instances_"+f).is(":checked")&&c.push(f),$("#dropdown_instances_"+f).hasClass("open")&&e.push(f);$(this.el).html(a);for(g in b)f=b[g],a=$("#checkbox_images_"+f),null!=a.html()&&a.prop("checked",!0);for(g in d)f=d[g],b=$("#dropdown_images_"+f),null!=b.html()&&b.addClass("open");
for(g in c)f=c[g],a=$("#checkbox_instances_"+f),null!=a.html()&&a.prop("checked",!0);for(g in e)f=e[g],b=$("#dropdown_instances_"+f),null!=b.html()&&b.addClass("open")}this.enableDisableDeleteButtonImages();this.enableDisableDeleteButtonInstances();return this}});var InstancesAndVolumesView=Backbone.View.extend({_template:_.itemplate($("#novaInstancesAndVolumesTemplate").html()),instancesView:void 0,volumesView:void 0,initialize:function(){this.render();this.instancesView=new NovaInstancesView({model:this.options.instancesModel,flavors:this.options.flavors,el:"#instances"});this.volumesView=new NovaVolumesView({model:this.options.volumesModel,volumeSnapshotsModel:this.options.volumeSnapshotModel,instances:this.options.instancesModel,el:"#volumes"})},onClose:function(){this.instancesView.onClose();
this.volumesView.onClose();this.undelegateEvents();this.unbind()},render:function(){UTILS.Render.animateRender(this.el,this._template)}});var NovaInstancesView=Backbone.View.extend({_template:_.itemplate($("#novaInstancesTemplate").html()),dropdownId:void 0,initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.render,this);this.renderFirst()},events:{"change .checkbox_instances":"enableDisableTerminateButton","click .btn-edit-instances":"onEditInstance","click .btn-snapshot":"onSnapshot","click .btn-pause":"onPause","click .btn-unpause":"onUnpause","click .btn-suspend":"onSuspend","click .btn-resume":"onResume",
"click .btn-password":"onChangePassword","click .btn-reboot":"onReboot","click .btn-terminate":"onTerminate","click .btn-terminate-group":"onTerminateGroup"},onClose:function(){this.undelegateEvents();this.unbind()},onEditInstance:function(a){(new UpdateInstanceView({el:"body",model:this.model.get(a.target.value)})).render()},onSnapshot:function(a){(new CreateSnapshotView({el:"body",model:this.model.get(a.target.value)})).render()},onPause:function(a){a=this.model.get(a.target.value);a.pauseserver();
(new MessagesView({el:"#content",state:"Success",title:"Instance "+a.get("name")+" paused."})).render()},onUnpause:function(a){a=this.model.get(a.target.value);a.unpauseserver();(new MessagesView({el:"#content",state:"Success",title:"Instance "+a.get("name")+" unpaused."})).render()},onSuspend:function(a){a=this.model.get(a.target.value);a.suspendserver();(new MessagesView({el:"#content",state:"Success",title:"Instance "+a.get("name")+" suspended."})).render()},onResume:function(a){a=this.model.get(a.target.value);
a.resumeserver();(new MessagesView({el:"#content",state:"Success",title:"Instance "+a.get("name")+" resumed."})).render()},onChangePassword:function(a){(new ChangePasswordView({el:"body",model:this.model.get(a.target.value)})).render()},onReboot:function(a){var b=this.model.get(a.target.value);(new ConfirmView({el:"body",title:"Reboot Instance",btn_message:"Reboot Instance",onAccept:function(){b.reboot(!1);(new MessagesView({el:"#content",state:"Success",title:"Instance "+b.get("name")+" rebooted."})).render()}})).render()},
onTerminate:function(a){var b=this.model.get(a.target.value);(new ConfirmView({el:"body",title:"Terminate Instance",btn_message:"Terminate Instance",onAccept:function(){b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Instance "+b.get("name")+" terminated."})).render()}})).render()},onTerminateGroup:function(){var a=this;(new ConfirmView({el:"body",title:"Terminate Instances",btn_message:"Terminate Instances",onAccept:function(){$(".checkbox:checked").each(function(){var b=$(this).val(),
b=a.model.get(b);b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Instances "+b.get("name")+" terminated."})).render()})}})).render()},enableDisableTerminateButton:function(){0<$(".checkbox_instances:checked").size()?$("#instances_terminate").attr("disabled",!1):$("#instances_terminate").attr("disabled",!0)},renderFirst:function(){$(this.el).html(this._template({models:this.model.models,flavors:this.options.flavors}));this.undelegateEvents();this.delegateEvents(this.events)},render:function(){this.undelegateEvents();
this.delegateEvents(this.events);if(null!=$(this.el).html()){var a=this._template({models:this.model.models,flavors:this.options.flavors}),b=[],d=[],c,e;for(c in this.model.models)e=this.model.models[c].id,$("#checkbox_"+e).is(":checked")&&b.push(e),$("#dropdown_"+e).hasClass("open")&&d.push(e);$(this.el).html(a);for(c in b)e=b[c],a=$("#checkbox_"+e),null!=a.html()&&a.prop("checked",!0);for(c in d)e=d[c],b=$("#dropdown_"+e),null!=b.html()&&b.addClass("open")}this.enableDisableTerminateButton();return this}});var NovaKeypairsView=Backbone.View.extend({_template:_.itemplate($("#novaKeypairsTemplate").html()),initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.render,this);this.renderFirst()},events:{"change .checkbox_keypairs":"enableDisableDeleteButton","click #delete_keypair":"deleteKeypair","click #delete_keypairs":"deleteKeypairs","click .btn-create":"createKeypair","click .btn-import":"importKeypair"},deleteKeypair:function(a){var b=this.model.get(a.target.value);(new ConfirmView({el:"body",
title:"Delete Keypair",btn_message:"Delete Keypair",onAccept:function(){b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Keypair "+a.target.value+" deleted."})).render()}})).render()},deleteKeypairs:function(){var a=this;(new ConfirmView({el:"body",title:"Delete Keypairs",btn_message:"Delete Keypairs",onAccept:function(){$(".checkbox_keypairs:checked").each(function(){var b=$(this).val();a.model.get(b).destroy();(new MessagesView({el:"#content",state:"Success",title:"Keypairs "+
b+" deleted."})).render()})}})).render()},createKeypair:function(){(new CreateKeypairView({el:"body",model:this.model})).render()},importKeypair:function(){(new ImportKeypairView({el:"body",model:this.model})).render()},enableDisableDeleteButton:function(){0<$(".checkbox_keypairs:checked").size()?$("#delete_keypairs").attr("disabled",!1):$("#delete_keypairs").attr("disabled",!0)},renderFirst:function(){this.undelegateEvents();var a=this;UTILS.Render.animateRender(this.el,this._template,{models:this.model.models},
function(){a.enableDisableDeleteButton();a.delegateEvents(a.events)})},render:function(){this.undelegateEvents();null!=$(".messages").html()&&$(".messages").remove();if(null!=$("#keypairs").html()){var a=this._template({models:this.model.models}),b=[],d,c;for(d in this.model.models)c=this.model.models[d].id,$("#checkbox_keypairs_"+c).is(":checked")&&b.push(c);$(this.el).html(a);for(d in b)c=b[d],a=$("#checkbox_keypairs_"+c),null!=a.html()&&a.prop("checked",!0);this.enableDisableDeleteButton()}this.delegateEvents(this.events);
return this}});var NovaOverviewView=Backbone.View.extend({_template:_.itemplate($("#novaOverviewTemplate").html()),initialize:function(){},render:function(){UTILS.Render.animateRender(this.el,this._template,this.model,function(){$("#option_id").selectbox();$("#option_id2").selectbox()});return this}});var NovaSecurityGroupsView=Backbone.View.extend({_template:_.itemplate($("#novaSecurityGroupsTemplate").html()),initialize:function(){this.options.securityGroupsModel.unbind("reset");this.options.securityGroupsModel.bind("reset",this.render,this);this.renderFirst()},events:{"change .checkbox_sec_groups":"enableDisableDeleteButton","click .btn-create-sec-group":"createSecurityGroup","click .btn-edit":"editSecurityGroupRules","click #sec_groups_delete":"deleteSecurityGroups","click #sec_delete":"deleteSecurityGroup"},
onClose:function(){this.undelegateEvents();this.unbind()},createSecurityGroup:function(){(new CreateSecurityGroupView({el:"body",securityGroupsModel:this.options.securityGroupsModel})).render()},editSecurityGroupRules:function(a){var b,d;for(d in this.options.securityGroupsModel.models)this.options.securityGroupsModel.models[d].id==a.target.value&&(b=this.options.securityGroupsModel.models[d]);this.options.securityGroup=b;(new EditSecurityGroupRulesView({el:"body",securityGroupsModel:this.options})).render()},
deleteSecurityGroup:function(a){var b,d;for(d in this.options.securityGroupsModel.models)this.options.securityGroupsModel.models[d].id==a.target.value&&(b=this.options.securityGroupsModel.models[d]);(new ConfirmView({el:"body",title:"Delete Security Group",btn_message:"Delete Security Group",onAccept:function(){b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Security Group "+b.attributes.name+" deleted."})).render()}})).render()},deleteSecurityGroups:function(){var a,b=this;(new ConfirmView({el:"body",
title:"Delete Security Groups",btn_message:"Delete Security Groups",onAccept:function(){$(".checkbox_sec_groups:checked").each(function(){var d=$(this).val(),c;for(c in b.options.securityGroupsModel.models)b.options.securityGroupsModel.models[c].id==d&&(a=b.options.securityGroupsModel.models[c]);a.destroy();(new MessagesView({el:"#content",state:"Success",title:"Security Groups "+a.attributes.name+" deleted."})).render()})}})).render()},enableDisableDeleteButton:function(){0<$(".checkbox_sec_groups:checked").size()?
$("#sec_groups_delete").attr("disabled",!1):$("#sec_groups_delete").attr("disabled",!0)},renderFirst:function(){this.undelegateEvents();var a=this;UTILS.Render.animateRender(this.el,this._template,{securityGroupsModel:this.options.securityGroupsModel},function(){a.enableDisableDeleteButton();a.delegateEvents(a.events)})},render:function(){this.undelegateEvents();null!=$(".messages").html()&&$(".messages").remove();if(null!=$("#security_groups").html()){var a=this._template({securityGroupsModel:this.options.securityGroupsModel}),
b=[],d,c;for(d in this.options.securityGroupsModel.models)c=this.options.securityGroupsModel.models[d].id,$("#checkbox_sec_groups_"+c).is(":checked")&&b.push(c);$(this.el).html(a);for(d in b)c=b[d],a=$("#checkbox_sec_groups_"+c),null!=a.html()&&a.prop("checked",!0);this.enableDisableDeleteButton()}this.delegateEvents(this.events);return this}});var NovaSnapshotsView=Backbone.View.extend({_template:_.itemplate($("#novaSnapshotsTemplate").html()),instanceSnapshotsView:void 0,volumeSnapshotsView:void 0,initialize:function(){console.log(this.options.images);this.render();this.instanceSnapshotsView=new NovaInstanceSnapshotsView({model:this.options.images,flavors:this.options.flavors,keypairs:this.options.keypairs,el:"#instance_snapshots"});this.volumeSnapshotsView=new NovaVolumeSnapshotsView({model:this.options.volumeSnapshotsModel,instancesModel:this.options.instancesModel,
volumesModel:this.options.volumesModel,flavors:this.options.flavors,el:"#volume_snapshots"})},onClose:function(){this.instanceSnapshotsView.onClose();this.volumeSnapshotsView.onClose();this.undelegateEvents();this.unbind()},render:function(){UTILS.Render.animateRender(this.el,this._template)}});var VDCServiceView=Backbone.View.extend({_template:_.itemplate($("#novaVDCServiceTemplate").html()),dropdownId:void 0,initialize:function(){var a=this;this.model.unbind("change");this.model.bind("change",this.render,this);this.model.fetch();this.timer=setInterval(function(){a.model.fetch()},4E3)},events:{"change .checkbox_instances":"enableDisableTerminateButton","click .btn-edit-instances":"onEditInstance","click .btn-snapshot":"onSnapshot","click .btn-pause":"onPause","click .btn-unpause":"onUnpause",
"click .btn-suspend":"onSuspend","click .btn-resume":"onResume","click .btn-password":"onChangePassword","click .btn-reboot":"onReboot","click .btn-terminate":"onTerminate","click .btn-terminate-group":"onTerminateGroup"},onClose:function(){this.undelegateEvents();this.unbind();this.model.unbind("change")},onEditInstance:function(a){(new UpdateInstanceView({el:"body",model:this.model.getInstance(a.target.value)})).render()},onSnapshot:function(a){(new CreateSnapshotView({el:"body",model:this.model.getInstance(a.target.value)})).render()},
onPause:function(a){a=this.model.getInstance(a.target.value);a.pauseserver();(new MessagesView({el:"#content",state:"Success",title:"Instance "+a.get("name")+" paused."})).render()},onUnpause:function(a){a=this.model.getInstance(a.target.value);a.unpauseserver();(new MessagesView({el:"#content",state:"Success",title:"Instance "+a.get("name")+" unpaused."})).render()},onSuspend:function(a){a=this.model.getInstance(a.target.value);a.suspendserver();(new MessagesView({el:"#content",state:"Success",title:"Instance "+
a.get("name")+" suspended."})).render()},onResume:function(a){a=this.model.getInstance(a.target.value);a.resumeserver();(new MessagesView({el:"#content",state:"Success",title:"Instance "+a.get("name")+" resumed."})).render()},onChangePassword:function(a){(new ChangePasswordView({el:"body",model:this.model.getInstance(a.target.value)})).render()},onReboot:function(a){var b=this.model.getInstance(a.target.value);(new ConfirmView({el:"body",title:"Reboot Instance",btn_message:"Reboot Instance",onAccept:function(){b.reboot(!1);
(new MessagesView({el:"#content",state:"Success",title:"Instance "+b.get("name")+" rebooted."})).render()}})).render()},onTerminate:function(a){var b=this.model.getInstance(a.target.value);(new ConfirmView({el:"body",title:"Terminate Instance",btn_message:"Terminate Instance",onAccept:function(){b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Instance "+b.get("name")+" terminated."})).render()}})).render()},onTerminateGroup:function(){var a=this;(new ConfirmView({el:"body",title:"Terminate Instances",
btn_message:"Terminate Instances",onAccept:function(){$(".checkbox:checked").each(function(){var b=$(this).val(),b=a.model.getInstance(b);b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Instances "+b.get("name")+" terminated."})).render()})}})).render()},enableDisableTerminateButton:function(){0<$(".checkbox_instances:checked").size()?$("#instances_terminate").attr("disabled",!1):$("#instances_terminate").attr("disabled",!0)},renderFirst:function(){UTILS.Render.animateRender(this.el,
this._template,{models:this.model.get("models"),vdc:this.options.vdc,service:this.model.get("name"),flavors:this.options.flavors});this.undelegateEvents();this.delegateEvents(this.events)},renderSecond:function(){this.undelegateEvents();this.delegateEvents(this.events);if(null!=$(this.el).html()){var a=this._template({models:this.model.get("models"),vdc:this.options.vdc,service:this.model.get("name"),flavors:this.options.flavors}),b=[],d=[],c,e;for(c in this.model.get("models"))e=this.model.get("models")[c].id,
$("#checkbox_"+e).is(":checked")&&b.push(e),$("#dropdown_"+e).hasClass("open")&&d.push(e);$(this.el).html(a);for(c in b)e=b[c],a=$("#checkbox_"+e),null!=a.html()&&a.prop("checked",!0);for(c in d)e=d[c],b=$("#dropdown_"+e),null!=b.html()&&b.addClass("open")}this.enableDisableTerminateButton();return this},render:function(){null===$("#vdcservice").html()?this.renderFirst():this.renderSecond()}});var VDCView=Backbone.View.extend({_template:_.itemplate($("#novaVDCTemplate").html()),dropdownId:void 0,timer:void 0,initialize:function(){var a=this;this.model.unbind("reset");this.model.bind("reset",this.render,this);this.model.fetch();this.timer=setInterval(function(){a.model.fetch()},4E3)},events:{"click .btn-launch":"onCreateService","click .btn-edit-service":"onEditService","click .btn-delete":"onDeleteService"},onClose:function(){this.model.unbind("reset");this.undelegateEvents();this.unbind();
clearInterval(this.timer)},onCreateService:function(){(new CreateVDCServiceView({el:"body",flavors:this.options.flavors,images:this.options.images,keypairs:this.options.keypairs})).render()},onEditService:function(){},onDeleteService:function(a){var b=this.model.get(a.target.value);(new ConfirmView({el:"body",title:"Delete Service",btn_message:"Delete VDC",message:"Please confirm your selection. This action cannot be undone and will delete all Instances associated to this Service.",onAccept:function(){vdc.destroy();
(new MessagesView({el:"#content",state:"Success",title:"Service "+b.get("name")+" deleted."})).render()}})).render()},renderFirst:function(){UTILS.Render.animateRender(this.el,this._template,{models:this.model.models,vdc:this.options.vdc});this.undelegateEvents();this.delegateEvents(this.events)},renderSecond:function(){this.undelegateEvents();this.delegateEvents(this.events);if(null!=$(this.el).html()){var a=this._template({models:this.model.models,vdc:this.options.vdc}),b=[],d,c;for(d in this.model.models)c=
this.model.models[d].id,$("#dropdown_"+c).hasClass("open")&&b.push(c);$(this.el).html(a);for(d in b)c=b[d],a=$("#dropdown_"+c),null!=a.html()&&a.addClass("open")}return this},render:function(){null==$("#vdc").html()?this.renderFirst():this.renderSecond()}});var VDCsView=Backbone.View.extend({_template:_.itemplate($("#novaVDCsTemplate").html()),dropdownId:void 0,initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.render,this);this.renderFirst()},events:{"click .btn-launch":"onLaunch","click .btn-edit-vdcs":"onEditVDC","click .btn-delete":"onDeleteVDC"},onLaunch:function(){(new LaunchVDCView({el:"body"})).render()},onClose:function(){this.model.unbind("reset");this.undelegateEvents();this.unbind()},onEditVDC:function(){},onDeleteVDC:function(a){var b=
this.model.get(a.target.value);(new ConfirmView({el:"body",title:"Delete VDC",btn_message:"Delete VDC",message:"Please confirm your selection. This action cannot be undone and will delete all Services and Instances associated to this Virtual Data Center",onAccept:function(){b.destroy();(new MessagesView({el:"#content",state:"Success",title:"VDC "+b.get("name")+" deleted."})).render()}})).render()},renderFirst:function(){UTILS.Render.animateRender(this.el,this._template,this.model);this.undelegateEvents();
this.delegateEvents(this.events)},render:function(){this.undelegateEvents();this.delegateEvents(this.events);if(null!=$(this.el).html()){var a=this._template({models:this.model.models}),b=[],d,c;for(d in this.model.models)c=this.model.models[d].id,$("#dropdown_"+c).hasClass("open")&&b.push(c);$(this.el).html(a);for(d in b)c=b[d],a=$("#dropdown_"+c),null!=a.html()&&a.addClass("open")}return this}});var VolumeDetailView=Backbone.View.extend({_template:_.itemplate($("#volumeDetailTemplate").html()),initialize:function(){this.model.bind("change",this.render,this);this.model.fetch()},render:function(){null==$("#volume_details").html()?UTILS.Render.animateRender(this.el,this._template,{model:this.model}):$(this.el).html(this._template({model:this.model}));return this}});var NovaVolumeSnapshotsView=Backbone.View.extend({_template:_.itemplate($("#novaVolumeSnapshotsTemplate").html()),dropdownId:void 0,events:{"change .checkbox":"enableDisableDeleteButton","click .btn-delete-volume":"onDelete","click .btn-delete-group":"onDeleteGroup"},initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.render,this);this.renderFirst()},onClose:function(){this.undelegateEvents();this.unbind()},enableDisableDeleteButton:function(){0<$(".checkbox:checked").size()?
$("#volume_snapshots_delete").attr("disabled",!1):$("#volume_snapshots_delete").attr("disabled",!0)},onDelete:function(a){var b=this.model.get(this.model.get(a.target.value));(new ConfirmView({el:"body",title:"Delete Volume Snapshot",btn_message:"Delete Volume Snapshot",onAccept:function(){b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Volume snapshot "+b.get("display_name")+" deleted."})).render()}})).render()},onDeleteGroup:function(){var a=this;(new ConfirmView({el:"body",
title:"Delete Volume Snapshots",btn_message:"Delete Images",onAccept:function(){$(".checkbox:checked").each(function(){var b=$(this).val(),b=a.model.get(b);b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Volume snapshot "+b.get("display_name")+" deleted."})).render()})}})).render()},renderFirst:function(){this.undelegateEvents();this.delegateEvents(this.events);$(this.el).html(this._template({models:this.model.models,instancesModel:this.options.instancesModel,volumesModel:this.options.volumesModel,
flavors:this.options.flavors}));this.undelegateEvents();this.delegateEvents(this.events)},render:function(){this.undelegateEvents();this.delegateEvents(this.events);if(null!==$("#volume_snapshots").html()){var a=this._template(this.model),b=[],d=[],c,e;for(c in this.model.models)e=this.model.models[c].id,$("#checkbox_"+e).is(":checked")&&b.push(e),$("#dropdown_"+e).hasClass("open")&&d.push(instanceId);$(this.el).html(a);for(c in b)e=b[c],a=$("#checkbox_"+e),null!==a.html()&&a.prop("checked",!0);for(c in d)e=
d[c],b=$("#dropdown_"+e),null!==b.html()&&b.addClass("open")}this.enableDisableDeleteButton();return this}});var NovaVolumesView=Backbone.View.extend({_template:_.itemplate($("#novaVolumesTemplate").html()),dropdownId:void 0,events:{"change .checkbox_volumes":"enableDisableDeleteButton","click .btn-create-volume":"onCreate","click .btn-edit-volumes":"onEdit","click .btn-delete-volume":"onDelete","click .btn-camera":"onSnapshot","click .btn-delete-group":"onDeleteGroup"},initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.render,this);this.render()},onClose:function(){this.undelegateEvents();
this.unbind();this.model.unbind("reset")},onCreate:function(){(new CreateVolumeView({el:"body"})).render()},onSnapshot:function(a){a=this.model.get(a.target.value);(new CreateVolumeSnapshotView({el:"body",model:a})).render()},onEdit:function(a){a=this.model.get(a.target.getAttribute("value"));(new EditVolumeAttachmentsView({el:"body",model:a,instances:this.options.instancesModel})).render()},onDelete:function(a){var b=this.model.get(a.target.value);(new ConfirmView({el:"body",title:"Delete Volume",
btn_message:"Delete Volume",onAccept:function(){b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Volume "+b.get("display_name")+" deleted."})).render()}})).render()},onDeleteGroup:function(){var a=this;(new ConfirmView({el:"body",title:"Delete Volume",btn_message:"Delete Volumes",onAccept:function(){$(".checkbox_volumes:checked").each(function(){var b=$(this).val(),b=a.model.get(b);b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Volume "+b.get("display_name")+
" deleted."})).render()})}})).render()},enableDisableDeleteButton:function(){0<$(".checkbox_volumes:checked").size()?$("#volumes_delete").attr("disabled",!1):$("#volumes_delete").attr("disabled",!0)},render:function(){null==$("#volumes").html()?this.renderFirst():this.renderSecond()},renderFirst:function(){this.undelegateEvents();this.delegateEvents(this.events);UTILS.Render.animateRender(this.el,this._template,{models:this.model.models,volumeSnapshotsModel:this.options.volumeSnapshotModel,instances:this.options.instancesModel});
this.undelegateEvents();this.delegateEvents(this.events)},renderSecond:function(){this.undelegateEvents();this.delegateEvents(this.events);if(null!=$(this.el).html()){var a=this._template({models:this.model.models,volumeSnapshotsModel:this.options.volumeSnapshotModel,flavors:this.options.flavors}),b=[],d=[],c,e;for(c in this.model.models)e=this.model.models[c].id,$("#checkbox_"+e).is(":checked")&&b.push(e),$("#dropdown_"+e).hasClass("open")&&d.push(e);$(this.el).html(a);for(c in b)e=b[c],a=$("#checkbox_"+
e),null!=a.html()&&a.prop("checked",!0);for(c in d)e=d[c],drop=$("#dropdown_"+e),null!=drop.html()&&drop.addClass("open")}this.enableDisableDeleteButton();return this}});var ObjectStorageContainerView=Backbone.View.extend({_template:_.itemplate($("#objectstorageContainerTemplate").html()),initialize:function(){this.model.unbind("reset");this.model.bind("change",this.renderFirst,this);this.model.bind("reset",this.render,this);this.model.fetch()},events:{"change .checkbox_objects":"enableDisableDeleteButton","change .checkbox_all":"checkAll","click .btn-upload":"onUploadObject","click .btn-copy":"onCopyObject","click .btn-download":"onDownloadObject","click .btn-delete":"onDelete",
"click #objects_delete":"onDeleteGroup"},onDownloadObject:function(){var a;a=$(".btn-download").attr("href").split("/");cont=a[a.length-2];obj=a[a.length-1];mySucess=function(a){a=new Blob([a],{type:"application/cdmi-object"});a=window.URL.createObjectURL(a);window.open(a)};CDMI.Actions.downloadobject(cont,obj,mySucess)},onUploadObject:function(){(new UploadObjectView({el:"body",model:this.model})).render()},onCopyObject:function(a){this.options.title=a.target.value;a=this.options.model.get("name");
(new CopyObjectView({el:"body",model:this.model,title:this.options.title,container:a,containers:this.options.containers.models})).render()},onClose:function(){this.undelegateEvents();this.unbind()},onDelete:function(a){var b,d=this,c;for(c in this.model.get("objects"))this.model.get("objects")[c].name===a.target.value&&this.model.get("objects");b=this.model.get("name");(new ConfirmView({el:"body",title:"Confirm Delete Object",btn_message:"Delete Object",onAccept:function(){d.model.deleteObject(b,
void 0);(new MessagesView({el:"#content",state:"Success",title:"Object "+(void 0).name+" deleted."})).render()}})).render()},onDeleteGroup:function(){var a=this,b,d=[];(new ConfirmView({el:"body",title:"Delete Objects",btn_message:"Delete Objects",onAccept:function(){var c=[];$(".checkbox_objects:checked").each(function(){var b=$(this).val(),b=a.model.get("objects")[b];c.push(b);(new MessagesView({el:"#content",state:"Success",title:"Object "+b.name+" deleted."})).render()});d=c;b=a.model.get("name");
a.model.deleteObjects(b,d)}})).render()},checkAll:function(){0<$(".checkbox_all:checked").size()?$(".checkbox_objects").attr("checked","checked"):$(".checkbox_objects").attr("checked",!1);this.enableDisableDeleteButton()},enableDisableDeleteButton:function(){0<$(".checkbox_objects:checked").size()?$("#objects_delete").attr("disabled",!1):$("#objects_delete").attr("disabled",!0)},render:function(){null!=$(".messages").html()&&$(".messages").remove();if(null!=$("#objects").html()){var a=this._template(this.model),
b=[],d,c;for(c in this.model.models)d=this.model.models[c].id,$("#checkbox_"+d).is(":checked")&&b.push(d);$(this.el).html(a);for(c in b)d=b[c],a=$("#checkbox_"+d),null!=a.html()&&a.prop("checked",!0);this.enableDisableDeleteButton()}this.delegateEvents(this.events);return this},renderFirst:function(){UTILS.Render.animateRender(this.el,this._template,{model:this.model,models:this.model.get("objects")})}});var ObjectStorageContainersView=Backbone.View.extend({_template:_.itemplate($("#objectstorageContainersTemplate").html()),initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.render,this);this.renderFirst()},events:{"change .checkbox_containers":"enableDisableDeleteButton","change .checkbox_all":"checkAll","click #containers__action_create":"onCreateContainer","click .btn-upload":"onUploadObject","click .btn-delete":"onDelete","click .btn-delete-group":"onDeleteGroup"},onCreateContainer:function(){(new CreateContainerView({el:"body",
model:this.model})).render()},onUploadObject:function(a){a=this.model.get(a.target.value);(new UploadObjectView({el:"body",model:a})).render()},onClose:function(){this.undelegateEvents();this.unbind()},onDelete:function(a){var b=a.target.value,d=this,c;(new ConfirmView({el:"body",title:"Confirm Delete Container",btn_message:"Delete Container",onAccept:function(){c=d.model.get(b);0<c.get("count")?(console.log(c),(new MessagesView({el:"#content",state:"Error",title:"Unable to delete non-empty container "+
c.get("id")})).render()):(c.destroy(),(new MessagesView({el:"#content",state:"Success",title:"Container "+c.get("id")+" deleted."})).render())}})).render()},onDeleteGroup:function(){var a=this,b;(new ConfirmView({el:"body",title:"Delete Containers",btn_message:"Delete Containers",onAccept:function(){$(".checkbox_containers:checked").each(function(){var d=$(this).val();b=a.model.get(d);0<b.get("count")?(new MessagesView({el:"#content",state:"Conflict",title:"Container "+b.get("id")+" contains objects."})).render():
(b.destroy(),(new MessagesView({el:"#content",state:"Success",title:"Container "+b.get("name")+" deleted."})).render())})}})).render()},checkAll:function(){0<$(".checkbox_all:checked").size()?$(".checkbox_containers").attr("checked","checked"):$(".checkbox_containers").attr("checked",!1);this.enableDisableDeleteButton()},enableDisableDeleteButton:function(){0<$(".checkbox_containers:checked").size()?$("#containers_terminate").attr("disabled",!1):$("#containers_terminate").attr("disabled",!0)},renderFirst:function(){UTILS.Render.animateRender(this.el,
this._template,{models:this.model.models});this.enableDisableDeleteButton()},render:function(){null!=$(".messages").html()&&$(".messages").remove();if(null!=$("#containers").html()){var a=this._template(this.model),b=[],d,c;for(d in this.model.models)c=this.model.models[d].id,$("#checkbox_"+c).is(":checked")&&b.push(c);$(this.el).html(a);for(d in b)c=b[d],a=$("#checkbox_"+c),null!=a.html()&&a.prop("checked",!0);this.enableDisableDeleteButton()}return this}});var FlavorView=Backbone.View.extend({_template:_.itemplate($("#flavorsTemplate").html()),initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.render,this);this.renderFirst()},events:{"change .checkbox":"enableDisableDeleteButton","click .btn-delete":"onDelete","click .btn-delete-group":"onDeleteGroup"},onClose:function(){this.undelegateEvents();this.unbind()},enableDisableDeleteButton:function(){0<$(".checkbox:checked").size()?$("#flavors_delete").attr("disabled",!1):$("#flavors_delete").attr("disabled",
!0)},onDelete:function(a){var b=this.model.get(a.target.value);console.log(b);(new ConfirmView({el:"body",title:"Delete Flavor",btn_message:"Delete Flavor",onAccept:function(){b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Flavor "+b.get("name")+" deleted."})).render()}})).render()},onDeleteGroup:function(){var a=this;(new ConfirmView({el:"body",title:"Delete Flavors",btn_message:"Delete Flavor",onAccept:function(){$(".checkbox:checked").each(function(){var b=$(this).val(),b=
a.model.get(b);console.log(b);b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Flavors "+b.get("name")+" deleted."})).render()})}})).render()},renderFirst:function(){UTILS.Render.animateRender(this.el,this._template,this.model);this.enableDisableDeleteButton()},render:function(){null!=$(".messages").html()&&$(".messages").remove();if(null!=$("#flavors").html()){var a=this._template(this.model),b=[],d,c;for(d in this.model.models)c=this.model.models[d].id,$("#checkbox_"+c).is(":checked")&&
b.push(c);$(this.el).html(a);for(d in b)c=b[d],a=$("#checkbox_"+c),null!=a.html()&&a.prop("checked",!0);this.enableDisableDeleteButton()}return this}});var ImagesView=Backbone.View.extend({_template:_.itemplate($("#imagesTemplate").html()),initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.render,this);this.renderFirst()},events:{"change .checkbox":"enableDisableDeleteButton","click .btn-delete":"onDelete","click .btn-delete-group":"onDeleteGroup","click .btn-launch":"onLaunch"},onClose:function(){this.undelegateEvents();this.unbind()},onLaunch:function(a){a=this.model.get(a.target.value);console.log("Showing Instance Creation");
(new LaunchImageView({el:"body",images:this.options.images,flavors:this.options.flavors,keypairs:this.options.keypairs,model:a})).render()},onDelete:function(a){var b=this.model.get(a.target.value);(new ConfirmView({el:"body",title:"Delete Image",btn_message:"Delete Image",onAccept:function(){b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Image "+b.get("name")+" deleted."})).render()}})).render()},onDeleteGroup:function(){var a=this;(new ConfirmView({el:"body",title:"Delete Images",
btn_message:"Delete Images",onAccept:function(){$(".checkbox:checked").each(function(){var b=$(this).val(),b=a.model.get(b);b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Images "+b.get("name")+" deleted."})).render()})}})).render()},enableDisableDeleteButton:function(){0<$(".checkbox:checked").size()?$("#images_delete").attr("disabled",!1):$("#images_delete").attr("disabled",!0)},renderFirst:function(){UTILS.Render.animateRender(this.el,this._template,this.model);this.enableDisableDeleteButton()},
render:function(){if(null!=$("#images").html()){var a=this._template(this.model),b=[],d=[],c,e;for(c in this.model.models)e=this.model.models[c].id,$("#checkbox_"+e).is(":checked")&&b.push(e),$("#dropdown_"+e).hasClass("open")&&d.push(e);$(this.el).html(a);for(c in b)e=b[c],a=$("#checkbox_"+e),null!=a.html()&&a.prop("checked",!0);for(c in d)e=d[c],b=$("#dropdown_"+e),null!=b.html()&&b.addClass("open");this.enableDisableDeleteButton()}return this}});var InstanceView=Backbone.View.extend({_template:_.itemplate($("#instancesTemplate").html()),dropdownId:void 0,initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.render,this);this.renderFirst()},events:{"change .checkbox":"enableDisableTerminateButton","click .btn-edit":"onEditInstance","click .btn-snapshot":"onSnapshot","click .btn-pause":"onPause","click .btn-unpause":"onUnpause","click .btn-suspend":"onSuspend","click .btn-resume":"onResume","click .btn-password":"onChangePassword",
"click .btn-reboot":"onReboot","click .btn-terminate":"onTerminate","click .btn-terminate-group":"onTerminateGroup"},onClose:function(){this.undelegateEvents();this.unbind();this.model.unbind("reset")},onEditInstance:function(a){(new UpdateInstanceView({el:"body",model:this.model.get(a.target.value)})).render()},onSnapshot:function(a){(new CreateSnapshotView({el:"body",model:this.model.get(a.target.value)})).render()},onPause:function(a){a=this.model.get(a.target.value);a.pauseserver();(new MessagesView({el:"#content",
state:"Success",title:"Instance "+a.get("name")+" paused."})).render()},onUnpause:function(a){a=this.model.get(a.target.value);a.unpauseserver();(new MessagesView({el:"#content",state:"Success",title:"Instance "+a.get("name")+" unpaused."})).render()},onSuspend:function(a){a=this.model.get(a.target.value);a.suspendserver();(new MessagesView({el:"#content",state:"Success",title:"Instance "+a.get("name")+" suspended."})).render()},onResume:function(a){a=this.model.get(a.target.value);a.resumeserver();
(new MessagesView({el:"#content",state:"Success",title:"Instance "+a.get("name")+" resumed."})).render()},onChangePassword:function(a){(new ChangePasswordView({el:"body",model:this.model.get(a.target.value)})).render()},onReboot:function(a){var b=this.model.get(a.target.value);(new ConfirmView({el:"body",title:"Reboot Instance",btn_message:"Reboot Instance",onAccept:function(){b.reboot(!1);(new MessagesView({el:"#content",state:"Success",title:"Instance "+b.get("name")+" rebooted."})).render()}})).render()},
onTerminate:function(a){var b=this.model.get(a.target.value);(new ConfirmView({el:"body",title:"Terminate Instance",btn_message:"Terminate Instance",onAccept:function(){b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Instance "+b.get("name")+" terminated."})).render()}})).render()},onTerminateGroup:function(){var a=this;(new ConfirmView({el:"body",title:"Terminate Instances",btn_message:"Terminate Instances",onAccept:function(){$(".checkbox:checked").each(function(){var b=$(this).val(),
b=a.model.get(b);b.destroy();(new MessagesView({el:"#content",state:"Success",title:"Instances "+b.get("name")+" terminated."})).render()})}})).render()},enableDisableTerminateButton:function(){0<$(".checkbox:checked").size()?$("#instances_terminate").attr("disabled",!1):$("#instances_terminate").attr("disabled",!0)},renderFirst:function(){UTILS.Render.animateRender(this.el,this._template,{models:this.model.models,projects:this.options.projects,flavors:this.options.flavors});this.enableDisableTerminateButton()},
render:function(){if(null!=$("#instances").html()){var a=this._template({models:this.model.models,projects:this.options.projects,flavors:this.options.flavors}),b=[],d=[],c,e;for(c in this.model.models)e=this.model.models[c].id,$("#checkbox_"+e).is(":checked")&&b.push(e),$("#dropdown_"+e).hasClass("open")&&d.push(e);$(this.el).html(a);for(c in b)e=b[c],a=$("#checkbox_"+e),null!=a.html()&&a.prop("checked",!0);for(c in d)e=d[c],b=$("#dropdown_"+e),null!=b.html()&&b.addClass("open");this.enableDisableTerminateButton()}return this}});var SysOverviewView=Backbone.View.extend({_template:_.itemplate($("#sysOverviewTemplate").html()),initialize:function(){},render:function(){UTILS.Render.animateRender(this.el,this._template,this.model,function(){$("#option_id").selectbox();$("#option_id2").selectbox()});return this}});var ProjectView=Backbone.View.extend({_template:_.itemplate($("#projectsTemplate").html()),initialize:function(){this.model.bind("reset",this.rerender,this);this.render()},onClose:function(){this.model.unbind("reset")},render:function(){UTILS.Render.animateRender(this.el,this._template,this.model);return this},rerender:function(){null!=$("#tenants").html()&&$(this.el).empty().html(this._template(this.model))}});var QuotaView=Backbone.View.extend({_template:_.itemplate($("#quotasTemplate").html()),initialize:function(){this.model.unbind("reset");this.model.bind("reset",this.rerender,this);this.model.fetch()},rerender:function(){UTILS.Render.animateRender(this.el,this._template,{models:this.model.models})}});var ServiceView=Backbone.View.extend({_template:_.itemplate($("#servicesTemplate").html()),initialize:function(){this.model.bind("reset",this.rerender,this);this.model.fetch()},render:function(){UTILS.Render.animateRender(this.el,this._template,this.model);return this},rerender:function(){$(this.el).empty().html(this._template(this.model))}});var UserView=Backbone.View.extend({_template:_.itemplate($("#usersTemplate").html()),initialize:function(){},render:function(){UTILS.Render.animateRender(this.el,this._template,this.model);return this},rerender:function(){$(this.el).empty().html(this._template(this.model))}});var NavTabView=Backbone.View.extend({_template:_.itemplate($("#navTabTemplate").html()),initialize:function(){this.model.bind("change:actives",this.render,this)},render:function(){$(this.el).empty().html(this._template({models:this.model.models,showAdmin:this.options.loginModel.isAdmin(),tenants:this.options.tenants,tenant:this.options.tenant}));return this}});var RootView=Backbone.View.extend({_roottemplate:_.itemplate($("#rootTemplate").html()),_authtemplate:_.itemplate($("#not_logged_in").html()),initialize:function(){$(this.options.auth_el).empty().html(this._authtemplate(this.model)).css("display","None");$(this.options.root_el).empty().html(this._roottemplate()).css("display","None");this.model.bind("change:loggedIn",this.onLogin,this);this.model.bind("auth-error",this.renderAuthonerror,this);this.onLogin()},onCredentialsSubmit:function(a){a.preventDefault();
this.model.setCredentials(this.$("input[name=username]").val(),this.$("input[name=password]").val())},onCloseErrorMsg:function(){this.model.set({error_msg:null});this.renderAuthonerror()},onLogin:function(){this.model.get("loggedIn")&&(window.location.href=void 0!==this.options.next_view?"#"+this.options.next_view:"#syspanel")},renderAuth:function(){this.$el=$(this.options.auth_el);this.delegateEvents({"click #home_loginbtn":"onCredentialsSubmit","click .close":"onCloseErrorMsg"});console.log(this.model.get("token"),
this.model.get("error_msg"),this.model.get("expired"));if(!(""!==this.model.get("token")&&null==this.model.get("error_msg")&&!0!==this.model.get("expired")))return console.log("Conditions passed"),"None"!==$(this.options.root_el).css("display")&&$(this.options.root_el).fadeOut(),$(this.options.auth_el).fadeIn(),this},renderRoot:function(){this.$el=$(this.options.auth_el);this.delegateEvents({});"None"!==$(this.options.auth_el).css("display")&&$(this.options.auth_el).fadeOut();$(this.options.auth_el).fadeOut();
$(this.options.root_el).fadeIn();return this},renderAuthonerror:function(){"none"==$(this.options.auth_el).css("display")&&$(this.options.auth_el).fadeIn();$(this.options.auth_el).empty().html(this._authtemplate(this.model));$("body").attr("id","splash");return this}});var SettingsView=Backbone.View.extend({_template:_.itemplate($("#settingsTemplate").html()),events:{"click #select":"changeLang"},initialize:function(){},changeLang:function(){$("select option:selected").each(function(){var a=$(this).attr("value");UTILS.i18n.setlang(a,function(){window.location.href=""})})},render:function(){$(this.el).empty().html(this._template())}});var SideBarView=Backbone.View.extend({_template:_.itemplate($("#sideBarTemplate").html()),initialize:function(){this.model.bind("change:actives",this.render,this);this.options.loginModel.bind("switch-tenant",this.render,this)},render:function(){$(this.el).empty().html(this._template({models:this.model.models,showTenants:this.options.showTenants,loginModel:this.options.loginModel,title:this.options.title}));$("#tenant_switcher").selectbox({onChange:function(a){window.location=a}})}});var TopBarView=Backbone.View.extend({_template:_.itemplate($("#topBarTemplate").html()),initialize:function(){this.model.bind("change:title",this.render,this);this.model.bind("change:subtitle",this.render,this);this.options.loginModel.bind("change:username",this.render,this)},render:function(){this.model.set({username:this.options.loginModel.get("username")});$(this.el).empty().html(this._template(this.model));return this}});
